Feature: 초록 캠핑장 핵심 인수 시나리오
  고객은 정책에 맞게 예약을 생성/조회/취소할 수 있고,
  시스템은 중복과 동시성을 올바르게 제어하며,
  연박 가용성 검색은 기간 전체를 정확히 반영해야 한다.

  Background:
    Given 캠핑장에 A-1부터 A-50까지 사이트가 등록되어 있다

  # 1) 예약 생성
  Scenario: 30일 이내 유효 기간으로 예약을 생성한다
    Given A-1 사이트가 비어있다
    When 고객이 이름, 전화번호, 날짜, 사이트 번호를 입력해 예약을 생성한다
    Then 예약이 확정되고 확인 코드를 발급받는다

  Scenario: 과거 날짜로는 예약할 수 없다
    Given A-1 사이트가 비어 있다
    When 고객이 과거 날짜로 예약을 시도한다
    Then 예약은 거부되고, 메시지에 "과거 날짜" 문구가 포함된다

  Scenario: 30일 제한을 초과하면 예약이 거부된다
    Given A-1 사이트가 비어있다
    When 고객이 30일 이후의 날짜로 예약을 시도한다
    Then 예약은 거부되고, 메시지에 "30일 이내" 문구가 포함된다

  Scenario: 전화번호가 없으면 예약할 수 없다
    Given A-1 사이트가 비어있다
    When 고객이 전화번호 없이 예약을 시도한다
    Then 예약은 거부되고, 메시지에 "전화번호" 문구가 포함된다
   
  # 2) 중복/동시성
  Scenario: 동일 기간/사이트 중복 예약은 거부된다
    Given A-2 사이트에 2025-09-25 ~ 2025-09-26 기간의 예약이 존재한다
    When 다른 고객이 같은 기간 같은 사이트로 예약을 시도한다
    Then 예약은 거부되고, 메시지에 "이미 예약" 문구가 포함된다

  Scenario: 동시에 같은 사이트를 예약하면 하나만 성공한다
    Given A-3 사이트가 2025-09-27 ~ 2025-09-28 기간 비어있다
    When 여러 고객이 동시에 같은 기간 같은 사이트를 예약한다
    Then 단 하나의 예약만 확정되고 나머지는 거부된다.

  Scenario: 취소된 예약은 즉시 재예약 가능하다
    Given A-4 사이트가 2025-09-29부터 2025-09-30까지 예약되어 있고 고객이 확인 코드를 보유한다
    And 고객이 해당 예약을 취소한다
    When 다른 고객이 같은 기간 같은 사이트를 예약한다
    Then 예약이 확정된다

  # 3) 기간 가용성(연박)
  Scenario: 기간 전체가 가능한 사이트만 반환한다
    Given A-5 사이트가 2025-09-20에는 예약되어 있고 2025-09-21에는 비어 있다
    When 고객이 2025-09-20부터 2025-09-21까지 연박 예약 가능 여부를 확인한다
    Then A-5 사이트는 예약 가능 목록에 포함되지 않는다

  Scenario: 고객은 원하는 크기의 사이트만 선택할 수 있다
    Given 캠핑장에 대형과 소형 사이트가 모두 존재한다
    When 고객이 2025-09-22부터 2025-09-23까지 대형 사이트만 검색한다
    Then 검색 결과에는 모든 사이트가 대형으로 표시된다
