# 초록 캠핑장 예약 시스템 기능 명세서

## 1. 예약 관리 기능

### 1.1 예약 생성
- **예약 기간 제한**: 예약은 오늘로부터 30일 이내에만 가능해야 한다
- **날짜 검증**: 
  - 과거 날짜로 예약 불가
  - 종료일이 시작일보다 이전일 수 없음
  - 시작일과 종료일은 필수 입력값
- **필수 정보**:
  - 예약자 이름 (필수, 빈 문자열 불가)
  - 전화번호 (필수, null 불가)
  - 캠핑 사이트 번호
- **중복 예약 방지**:
  - 동일 사이트, 동일 기간에 중복 예약 불가
  - 동시에 여러 요청이 들어와도 단 하나의 예약만 성공해야 함 (동시성 제어 필요)
  - 취소된 예약(CANCELLED 상태)은 중복 체크에서 제외되어야 함
- **확인 코드**: 예약 완료 시 6자리 영숫자 확인 코드 자동 생성

### 1.2 연박 예약
- **전체 기간 검증**: 연박 예약 시 시작일부터 종료일까지 모든 날짜에 대해 예약 가능 여부 확인 필요
- 시작일과 종료일뿐만 아니라 중간 날짜들도 모두 예약 가능해야 함

### 1.3 예약 조회
- 예약 ID로 개별 조회
- 날짜별 예약 현황 조회
- 고객 이름으로 예약 조회
- 이름과 전화번호로 내 예약 조회
- 키워드 검색 (이름 또는 전화번호 포함)

### 1.4 예약 수정
- **본인 확인**: 예약 수정 시 확인 코드 검증 필수
- 수정 가능 항목:
  - 캠핑 사이트 변경
  - 예약 날짜 변경
  - 고객 정보 변경 (이름, 전화번호)
- **변경 시 검증**: 새로운 날짜나 사이트로 변경 시 중복 예약 확인 필요

### 1.5 예약 취소
- **본인 확인**: 예약 취소 시 확인 코드 검증 필수
- **취소 정책**:
  - 당일 취소: 환불 불가
  - 사전 취소: 전액 환불 가능
- **환불 금액 계산**: 취소 시점에 따른 환불 금액 계산 로직 필요

## 2. 캠핑 사이트 관리

### 2.1 사이트 정보
- 사이트 번호 (A로 시작: 대형, B로 시작: 소형)
- 최대 수용 인원
- 사이트 설명

### 2.2 사이트 조회
- 전체 사이트 목록 조회
- 개별 사이트 상세 정보 조회

### 2.3 가용성 확인
- **단일 날짜 가용성**: 특정 날짜의 예약 가능한 사이트 조회
- **기간 검색**: 
  - 시작일과 종료일 지정하여 해당 기간 동안 예약 가능한 사이트 검색
  - 연박 예약을 위해 전체 기간 동안 가용한 사이트만 반환
- **필터링 옵션**:
  - 사이트 크기별 (대형/소형)

## 3. 캘린더 기능

### 3.1 월별 예약 현황
- 특정 사이트의 월별 예약 상태 조회
- 예약된 날짜와 가능한 날짜 구분 표시

## 4. 데이터 처리 요구사항

### 4.1 동시성 제어
- **중복 예약 방지**
- **격리 수준**: 동시성 문제 방지를 위한 적절한 트랜잭션 격리 수준 설정

## 5. 비즈니스 규칙 요약

1. **예약은 30일 이내만 가능**
2. **당일 취소 시 환불 불가**
3. **동시 예약 요청 시 단 하나만 성공**
4. **취소된 예약 사이트는 즉시 재예약 가능**
5. **연박 예약 시 전체 기간 가용성 확인 필수**
6. **예약 수정/취소는 본인 확인 후에만 가능**
7. **전화번호는 예약 시 필수 입력**
8. **과거 날짜로는 예약 불가**